import json
import os
import tkinter as tk
from tkinter import messagebox

# Get the absolute path of the folder where this script is located
BASE_DIR = os.path.dirname(os.path.abspath(__file__))
FILE_NAME = os.path.join(BASE_DIR, "phonebook.json")

def save_contact():
    first = entry_first.get().strip()
    last = entry_last.get().strip()

    # Validation
    if len(first) < 2 or len(last) < 2:
        messagebox.showerror("Error", "Both names must be at least 2 characters long.")
        return

    contact = {"first_name": first, "last_name": last}

    # Load existing data
    if os.path.exists(FILE_NAME):
        with open(FILE_NAME, "r", encoding="utf-8") as file:
            try:
                data = json.load(file)
            except json.JSONDecodeError:
                data = []
    else:
        data = []

    # Add new contact
    data.append(contact)

    # Save to file
    with open(FILE_NAME, "w", encoding="utf-8") as file:
        json.dump(data, file, indent=4, ensure_ascii=False)

    messagebox.showinfo("Saved", f"Contact {first} {last} saved successfully!")

    # Clear entries
    entry_first.delete(0, tk.END)
    entry_last.delete(0, tk.END)

# --- GUI setup ---
root = tk.Tk()
root.title("Phonebook App")
root.geometry("300x200")

# Labels & Entries
tk.Label(root, text="First Name:").pack(pady=5)
entry_first = tk.Entry(root)
entry_first.pack(pady=5)

tk.Label(root, text="Last Name:").pack(pady=5)
entry_last = tk.Entry(root)
entry_last.pack(pady=5)

# Save Button
tk.Button(root, text="Save", command=save_contact, width=10).pack(pady=15)

root.mainloop()
